{% extends 'base.html' %}
{% load static %}

{% block title %}Checkout | Robo Arena{% endblock %}

{% block content %}
<main style="padding-top: 100px;">
    <section class="section">
        <div class="container">
            <h1 class="section-title">Checkout</h1>
            
            <div class="checkout-layout" style="display: grid; grid-template-columns: 2fr 1fr; gap: 2rem; margin-top: 2rem;">
                
                <!-- Shipping Form -->
                <div class="checkout-form">
                    <div class="bg-card" style="border: 1px solid var(--border-subtle); border-radius: 4px; padding: 2rem;">
                        <h3 class="product-title" style="margin-bottom: 1.5rem;">Shipping Information</h3>
                        
                        <form action="{% url 'checkout' %}" method="POST" id="checkout-form">
                            {% csrf_token %}
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 1.5rem;">
                                <div class="form-group">
                                    <label class="form-label" style="display: block; margin-bottom: 0.5rem;">Full Name</label>
                                    <input type="text" name="full_name" required class="form-control" style="width: 100%; padding: 0.8rem; background: var(--bg-core); border: 1px solid var(--border-subtle); color: white;">
                                </div>
                                <div class="form-group">
                                    <label class="form-label" style="display: block; margin-bottom: 0.5rem;">Phone Number</label>
                                    <input type="text" name="phone_number" required class="form-control" style="width: 100%; padding: 0.8rem; background: var(--bg-core); border: 1px solid var(--border-subtle); color: white;">
                                </div>
                            </div>
                            
                            <div class="form-group" style="margin-bottom: 1.5rem;">
                                <label class="form-label" style="display: block; margin-bottom: 0.5rem;">Address</label>
                                <input type="text" name="address" required class="form-control" style="width: 100%; padding: 0.8rem; background: var(--bg-core); border: 1px solid var(--border-subtle); color: white;">
                            </div>
                            
                            <div class="form-group" style="margin-bottom: 2rem;">
                                <label class="form-label" style="display: block; margin-bottom: 0.5rem;">Location (Optional)</label>
                                <input type="text" name="location" placeholder="Landmarks, coordinates, etc." class="form-control" style="width: 100%; padding: 0.8rem; background: var(--bg-core); border: 1px solid var(--border-subtle); color: white;">
                            </div>
                            
                        </form>
                    </div>
                </div>

                <!-- Order Summary -->
                <div class="order-summary">
                    <div class="bg-card" style="border: 1px solid var(--border-subtle); border-radius: 4px; padding: 1.5rem;">
                        <h3 class="product-title" style="margin-bottom: 1rem;">Order Review</h3>
                        
                        <div class="summary-items" style="margin-bottom: 1.5rem; max-height: 300px; overflow-y: auto;">
                            {% for cart_item in cart_items %}
                            <div class="summary-item" style="display: flex; gap: 1rem; margin-bottom: 1rem;">
                                <div style="width: 50px; height: 50px; background: #fff; padding: 2px; display: flex; align-items: center; justify-content: center; border-radius: 4px;">
                                    {% if cart_item.product.primary_image %}
                                    <img src="{{ cart_item.product.primary_image.image.url }}" alt="{{ cart_item.product.name }}" style="max-height: 100%; width: auto;">
                                    {% else %}
                                    <img src="{% static 'assets/motor.png' %}" alt="{{ cart_item.product.name }}" style="max-height: 100%; width: auto;">
                                    {% endif %}
                                </div>
                                <div style="flex: 1;">
                                    <div style="font-weight: 600; font-size: 0.9rem;">{{ cart_item.product.name }}</div>
                                    <div style="font-size: 0.8rem; color: var(--text-muted);">Qty: {{ cart_item.quantity }} x ${{ cart_item.product.price }}</div>
                                </div>
                                <div style="font-family: var(--font-tech); font-size: 0.9rem;">${{ cart_item.sub_total }}</div>
                            </div>
                            {% endfor %}
                        </div>

                        <div style="height: 1px; background: var(--border-subtle); margin: 1rem 0;"></div>
                        
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem; color: var(--text-secondary);">
                            <span>Total Price:</span>
                            <span style="font-family: var(--font-tech);">${{ total }}</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem; color: var(--text-secondary);">
                            <span>Tax:</span>
                            <span style="font-family: var(--font-tech);">${{ tax }}</span>
                        </div>
                        <div style="height: 1px; background: var(--border-subtle); margin: 1rem 0;"></div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 1.5rem; font-weight: 700;">
                            <span>Grand Total:</span>
                            <span style="font-family: var(--font-tech); font-size: 1.25rem; color: var(--accent-primary);">${{ grand_total }}</span>
                        </div>
                        
                        <button type="submit" form="checkout-form" class="btn btn-primary" style="width: 100%;">Place Order</button>
                    </div>
                </div>
                
            </div>
        </div>
    </section>
</main>
{% endblock %}
